function InfoBox(a){a=a||{},google.maps.OverlayView.apply(this,arguments),this.content_=a.content||"",this.disableAutoPan_=a.disableAutoPan||!1,this.maxWidth_=a.maxWidth||0,this.pixelOffset_=a.pixelOffset||new google.maps.Size(0,0),this.position_=a.position||new google.maps.LatLng(0,0),this.zIndex_=a.zIndex||null,this.boxClass_=a.boxClass||"infoBox",this.boxStyle_=a.boxStyle||{},this.closeBoxMargin_=a.closeBoxMargin||"2px",this.closeBoxURL_=a.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif",""===a.closeBoxURL&&(this.closeBoxURL_=""),this.infoBoxClearance_=a.infoBoxClearance||new google.maps.Size(1,1),this.isHidden_=a.isHidden||!1,this.alignBottom_=a.alignBottom||!1,this.pane_=a.pane||"floatPane",this.enableEventPropagation_=a.enableEventPropagation||!1,this.div_=null,this.closeListener_=null,this.eventListener1_=null,this.eventListener2_=null,this.eventListener3_=null,this.moveListener_=null,this.contextListener_=null,this.fixedWidthSet_=null}function Marker(a){google.maps.Marker.apply(this,arguments),a.label&&(this.MarkerLabel=new MarkerLabel({map:this.map,marker:this,text:a.label}),this.MarkerLabel.bindTo("position",this,"position"))}InfoBox.prototype=new google.maps.OverlayView,InfoBox.prototype.createInfoBoxDiv_=function(){var a,b=this,c=function(a){a.cancelBubble=!0,a.stopPropagation&&a.stopPropagation()},d=function(a){a.returnValue=!1,a.preventDefault&&a.preventDefault(),b.enableEventPropagation_||c(a)};this.div_||(this.div_=document.createElement("div"),this.setBoxStyle_(),"undefined"==typeof this.content_.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+this.content_:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(this.content_)),this.getPanes()[this.pane_].appendChild(this.div_),this.addClickHandler_(),this.div_.style.width?this.fixedWidthSet_=!0:0!==this.maxWidth_&&this.div_.offsetWidth>this.maxWidth_?(this.div_.style.width=this.maxWidth_,this.div_.style.overflow="auto",this.fixedWidthSet_=!0):(a=this.getBoxWidths_(),this.div_.style.width=this.div_.offsetWidth-a.left-a.right+"px",this.fixedWidthSet_=!1),this.panBox_(this.disableAutoPan_),this.enableEventPropagation_||(this.eventListener1_=google.maps.event.addDomListener(this.div_,"mousedown",c),this.eventListener2_=google.maps.event.addDomListener(this.div_,"click",c),this.eventListener3_=google.maps.event.addDomListener(this.div_,"dblclick",c),this.eventListener4_=google.maps.event.addDomListener(this.div_,"mouseover",function(){this.style.cursor="default"})),this.contextListener_=google.maps.event.addDomListener(this.div_,"contextmenu",d),google.maps.event.trigger(this,"domready"))},InfoBox.prototype.getCloseBoxImg_=function(){var a="";return""!==this.closeBoxURL_&&(a="<img",a+=" src='"+this.closeBoxURL_+"'",a+=" align=right",a+=" style='",a+=" position: relative;",a+=" cursor: pointer;",a+=" margin: "+this.closeBoxMargin_+";",a+="'>"),a},InfoBox.prototype.addClickHandler_=function(){var a;""!==this.closeBoxURL_?(a=this.div_.firstChild,this.closeListener_=google.maps.event.addDomListener(a,"click",this.getCloseClickHandler_())):this.closeListener_=null},InfoBox.prototype.getCloseClickHandler_=function(){var a=this;return function(b){b.cancelBubble=!0,b.stopPropagation&&b.stopPropagation(),a.close(),google.maps.event.trigger(a,"closeclick")}},InfoBox.prototype.panBox_=function(a){var b,c,d=0,e=0;if(!a&&(b=this.getMap(),b instanceof google.maps.Map)){b.getBounds().contains(this.position_)||b.setCenter(this.position_),c=b.getBounds();var f=b.getDiv(),g=f.offsetWidth,h=f.offsetHeight,i=this.pixelOffset_.width,j=this.pixelOffset_.height,k=this.div_.offsetWidth,l=this.div_.offsetHeight,m=this.infoBoxClearance_.width,n=this.infoBoxClearance_.height,o=this.getProjection().fromLatLngToContainerPixel(this.position_);if(o.x<-i+m?d=o.x+i-m:o.x+k+i+m>g&&(d=o.x+k+i+m-g),this.alignBottom_?o.y<-j+n+l?e=o.y+j-n-l:o.y+j+n>h&&(e=o.y+j+n-h):o.y<-j+n?e=o.y+j-n:o.y+l+j+n>h&&(e=o.y+l+j+n-h),0!==d||0!==e){{b.getCenter()}b.panBy(d,e)}}},InfoBox.prototype.setBoxStyle_=function(){var a,b;if(this.div_){this.div_.className=this.boxClass_,this.div_.style.cssText="",b=this.boxStyle_;for(a in b)b.hasOwnProperty(a)&&(this.div_.style[a]=b[a]);"undefined"!=typeof this.div_.style.opacity&&""!==this.div_.style.opacity&&(this.div_.style.filter="alpha(opacity="+100*this.div_.style.opacity+")"),this.div_.style.position="absolute",this.div_.style.visibility="hidden",null!==this.zIndex_&&(this.div_.style.zIndex=this.zIndex_)}},InfoBox.prototype.getBoxWidths_=function(){var a,b={top:0,bottom:0,left:0,right:0},c=this.div_;return document.defaultView&&document.defaultView.getComputedStyle?(a=c.ownerDocument.defaultView.getComputedStyle(c,""),a&&(b.top=parseInt(a.borderTopWidth,10)||0,b.bottom=parseInt(a.borderBottomWidth,10)||0,b.left=parseInt(a.borderLeftWidth,10)||0,b.right=parseInt(a.borderRightWidth,10)||0)):document.documentElement.currentStyle&&c.currentStyle&&(b.top=parseInt(c.currentStyle.borderTopWidth,10)||0,b.bottom=parseInt(c.currentStyle.borderBottomWidth,10)||0,b.left=parseInt(c.currentStyle.borderLeftWidth,10)||0,b.right=parseInt(c.currentStyle.borderRightWidth,10)||0),b},InfoBox.prototype.onRemove=function(){this.div_&&(this.div_.parentNode.removeChild(this.div_),this.div_=null)},InfoBox.prototype.draw=function(){this.createInfoBoxDiv_();var a=this.getProjection().fromLatLngToDivPixel(this.position_);this.div_.style.left=a.x+this.pixelOffset_.width+"px",this.alignBottom_?this.div_.style.bottom=-(a.y+this.pixelOffset_.height)+"px":this.div_.style.top=a.y+this.pixelOffset_.height+"px",this.div_.style.visibility=this.isHidden_?"hidden":"visible"},InfoBox.prototype.setOptions=function(a){"undefined"!=typeof a.boxClass&&(this.boxClass_=a.boxClass,this.setBoxStyle_()),"undefined"!=typeof a.boxStyle&&(this.boxStyle_=a.boxStyle,this.setBoxStyle_()),"undefined"!=typeof a.content&&this.setContent(a.content),"undefined"!=typeof a.disableAutoPan&&(this.disableAutoPan_=a.disableAutoPan),"undefined"!=typeof a.maxWidth&&(this.maxWidth_=a.maxWidth),"undefined"!=typeof a.pixelOffset&&(this.pixelOffset_=a.pixelOffset),"undefined"!=typeof a.alignBottom&&(this.alignBottom_=a.alignBottom),"undefined"!=typeof a.position&&this.setPosition(a.position),"undefined"!=typeof a.zIndex&&this.setZIndex(a.zIndex),"undefined"!=typeof a.closeBoxMargin&&(this.closeBoxMargin_=a.closeBoxMargin),"undefined"!=typeof a.closeBoxURL&&(this.closeBoxURL_=a.closeBoxURL),"undefined"!=typeof a.infoBoxClearance&&(this.infoBoxClearance_=a.infoBoxClearance),"undefined"!=typeof a.isHidden&&(this.isHidden_=a.isHidden),"undefined"!=typeof a.enableEventPropagation&&(this.enableEventPropagation_=a.enableEventPropagation),this.div_&&this.draw()},InfoBox.prototype.setContent=function(a){this.content_=a,this.div_&&(this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.fixedWidthSet_||(this.div_.style.width=""),"undefined"==typeof a.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+a:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(a)),this.fixedWidthSet_||(this.div_.style.width=this.div_.offsetWidth+"px","undefined"==typeof a.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+a:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(a))),this.addClickHandler_()),google.maps.event.trigger(this,"content_changed")},InfoBox.prototype.setPosition=function(a){this.position_=a,this.div_&&this.draw(),google.maps.event.trigger(this,"position_changed")},InfoBox.prototype.setZIndex=function(a){this.zIndex_=a,this.div_&&(this.div_.style.zIndex=a),google.maps.event.trigger(this,"zindex_changed")},InfoBox.prototype.getContent=function(){return this.content_},InfoBox.prototype.getPosition=function(){return this.position_},InfoBox.prototype.getZIndex=function(){return this.zIndex_},InfoBox.prototype.show=function(){this.isHidden_=!1,this.div_&&(this.div_.style.visibility="visible")},InfoBox.prototype.hide=function(){this.isHidden_=!0,this.div_&&(this.div_.style.visibility="hidden")},InfoBox.prototype.open=function(a,b){var c=this;b&&(this.position_=b.getPosition(),this.moveListener_=google.maps.event.addListener(b,"position_changed",function(){c.setPosition(this.getPosition())})),this.setMap(a),this.div_&&this.panBox_()},InfoBox.prototype.close=function(){this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.eventListener1_&&(google.maps.event.removeListener(this.eventListener1_),google.maps.event.removeListener(this.eventListener2_),google.maps.event.removeListener(this.eventListener3_),google.maps.event.removeListener(this.eventListener4_),this.eventListener1_=null,this.eventListener2_=null,this.eventListener3_=null,this.eventListener4_=null),this.moveListener_&&(google.maps.event.removeListener(this.moveListener_),this.moveListener_=null),this.contextListener_&&(google.maps.event.removeListener(this.contextListener_),this.contextListener_=null),this.setMap(null)},window.onload=function(){function a(a,b){var c=a.innerHTML;a.innerHTML="<span style=\"font-family: 'map-icons'\">"+b+"</span>"+c}var b,c,d,e,f={"map-icon-map-pin":"&#xe000;","map-icon-expand":"&#xe001;","map-icon-fullscreen":"&#xe002;","map-icon-square-pin":"&#xe003;","map-icon-route-pin":"&#xe004;","map-icon-shield":"&#xe005;","map-icon-liquor_store":"&#xe006;","map-icon-bicycle_store":"&#xe007;","map-icon-hardware_store":"&#xe008;","map-icon-insurance_agency":"&#xe009;","map-icon-lawyer":"&#xe00a;","map-icon-real_estate_agency":"&#xe00b;","map-icon-art_gallery":"&#xe00c;","map-icon-campground":"&#xe00d;","map-icon-bakery":"&#xe00e;","map-icon-bar":"&#xe00f;","map-icon-amusement_park":"&#xe010;","map-icon-aquarium":"&#xe011;","map-icon-airport":"&#xe012;","map-icon-bank":"&#xe013;","map-icon-car_rental":"&#xe016;","map-icon-car_dealer":"&#xe017;","map-icon-hospital":"&#xe018;","map-icon-hair_care":"&#xe019;","map-icon-gym":"&#xe01a;","map-icon-grocery_or_supermarket":"&#xe01b;","map-icon-general_contractor":"&#xe01c;","map-icon-pharmacy":"&#xe01d;","map-icon-point_of_interest":"&#xe01e;","map-icon-political":"&#xe01f;","map-icon-post_box":"&#xe020;","map-icon-health":"&#xe021;","map-icon-post_office":"&#xe022;","map-icon-real_estate_agency-copy":"&#xe023;","map-icon-hindu_temple":"&#xe024;","map-icon-restaurant":"&#xe025;","map-icon-female":"&#xe026;","map-icon-male":"&#xe027;","map-icon-zoo":"&#xe028;","map-icon-veterinary_care":"&#xe029;","map-icon-car_repair":"&#xe02a;","map-icon-university":"&#xe02b;","map-icon-travel_agency":"&#xe02c;","map-icon-transit_station":"&#xe02d;","map-icon-beauty_salon":"&#xe02e;","map-icon-electronics_store":"&#xe02f;","map-icon-search":"&#xe030;","map-icon-zoom-out-alt":"&#xe031;","map-icon-movie_rental":"&#xe032;","map-icon-atm":"&#xe033;","map-icon-jewelry_store":"&#xe034;","map-icon-car_wash":"&#xe035;","map-icon-unisex":"&#xe036;","map-icon-rv_park":"&#xe037;","map-icon-school":"&#xe038;","map-icon-clothing_store":"&#xe039;","map-icon-laundry":"&#xe03a;","map-icon-casino":"&#xe03b;","map-icon-place_of_worship":"&#xe03c;","map-icon-furniture_store":"&#xe03d;","map-icon-zoom-in-alt":"&#xe03e;","map-icon-zoom-in":"&#xe03f;","map-icon-department_store":"&#xe040;","map-icon-fire_station":"&#xe041;","map-icon-church":"&#xe042;","map-icon-library":"&#xe043;","map-icon-shopping_mall":"&#xe044;","map-icon-local_government":"&#xe045;","map-icon-spa":"&#xe046;","map-icon-convenience_store":"&#xe047;","map-icon-police":"&#xe048;","map-icon-route":"&#xe049;","map-icon-zoom-out":"&#xe04a;","map-icon-location-arrow":"&#xe04b;","map-icon-postal_code":"&#xe04c;","map-icon-locksmith":"&#xe04d;","map-icon-doctor":"&#xe04e;","map-icon-mosque":"&#xe04f;","map-icon-stadium":"&#xe050;","map-icon-storage":"&#xe051;","map-icon-movie_theater":"&#xe052;","map-icon-electrician":"&#xe053;","map-icon-moving_company":"&#xe054;","map-icon-postal_code_prefix":"&#xe055;","map-icon-crosshairs":"&#xe056;","map-icon-compass":"&#xe057;","map-icon-dentist":"&#xe058;","map-icon-plumber":"&#xe059;","map-icon-museum":"&#xe05b;","map-icon-finance":"&#xe05a;","map-icon-parking":"&#xe05c;","map-icon-courthouse":"&#xe05d;","map-icon-accounting":"&#xe05e;","map-icon-store":"&#xe05f;","map-icon-subway_station":"&#xe060;","map-icon-natural_feature":"&#xe061;","map-icon-florist":"&#xe062;","map-icon-food":"&#xe063;","map-icon-night_club":"&#xe064;","map-icon-synagogue":"&#xe065;","map-icon-taxi_stand":"&#xe066;","map-icon-painter":"&#xe067;","map-icon-train_station":"&#xe068;","map-icon-pet_store":"&#xe069;","map-icon-gas_station":"&#xe06a;","map-icon-funeral_home":"&#xe06b;","map-icon-cemetery":"&#xe06c;","map-icon-bowling_alley":"&#xe06d;","map-icon-roofing_contractor":"&#xe06e;","map-icon-physiotherapist":"&#xe06f;","map-icon-embassy":"&#xe070;","map-icon-city_hall":"&#xe071;","map-icon-bus_station":"&#xe072;","map-icon-park":"&#xe073;","map-icon-lodging":"&#xe074;","map-icon-toilet":"&#xe075;","map-icon-circle":"&#xe076;","map-icon-square-rounded":"&#xe077;","map-icon-square":"&#xe078;","map-icon-book_store":"&#xe014;","map-icon-cafe":"&#xe015;","map-icon-wheelchair":"&#xe079;","map-icon-volume-control-telephone":"&#xe07a;","map-icon-sign-language":"&#xe07b;","map-icon-low-vision-access":"&#xe07c;","map-icon-open-captioning":"&#xe07d;","map-icon-closed-captioning":"&#xe07e;","map-icon-braille":"&#xe07f;","map-icon-audio-description":"&#xe080;","map-icon-assistive-listening-system":"&#xe081;","map-icon-abseiling":"&#xe082;","map-icon-tennis":"&#xe083;","map-icon-skateboarding":"&#xe084;","map-icon-playground":"&#xe085;","map-icon-inline-skating":"&#xe086;","map-icon-hang-gliding":"&#xe087;","map-icon-climbing":"&#xe088;","map-icon-baseball":"&#xe089;","map-icon-archery":"&#xe08a;","map-icon-wind-surfing":"&#xe08b;","map-icon-scuba-diving":"&#xe08c;","map-icon-sailing":"&#xe08d;","map-icon-marina":"&#xe08e;","map-icon-canoe":"&#xe08f;","map-icon-boat-tour":"&#xe090;","map-icon-boat-ramp":"&#xe091;","map-icon-swimming":"&#xe092;","map-icon-whale-watching":"&#xe093;","map-icon-waterskiing":"&#xe094;","map-icon-surfing":"&#xe095;","map-icon-rafting":"&#xe096;","map-icon-kayaking":"&#xe097;","map-icon-jet-skiing":"&#xe099;","map-icon-fishing-pier":"&#xe09a;","map-icon-fish-cleaning":"&#xe09b;","map-icon-diving":"&#xe09c;","map-icon-boating":"&#xe09d;","map-icon-fishing":"&#xe098;","map-icon-cross-country-skiing":"&#xe09e;","map-icon-skiing":"&#xe09f;","map-icon-snowmobile":"&#xe0a0;","map-icon-snowboarding":"&#xe0a1;","map-icon-snow":"&#xe0a2;","map-icon-snow-shoeing":"&#xe0a3;","map-icon-sledding":"&#xe0a4;","map-icon-ski-jumping":"&#xe0a5;","map-icon-ice-skating":"&#xe0a6;","map-icon-ice-fishing":"&#xe0a7;","map-icon-chairlift":"&#xe0a8;","map-icon-golf":"&#xe0a9;","map-icon-horse-riding":"&#xe0aa;","map-icon-motobike-trail":"&#xe0ab;","map-icon-trail-walking":"&#xe0ac;","map-icon-viewing":"&#xe0ad;","map-icon-walking":"&#xe0ae;","map-icon-bicycling":"&#xe0af;"},g=document.getElementsByTagName("*");for(b=0;e=g[b],e;b+=1)c=e.getAttribute("data-icon"),c&&a(e,c),d=e.className,d=d.match(/map-icon-[^\s'"]+/),d&&f[d[0]]&&a(e,f[d[0]])};var MAP_PIN="M0-165c-27.618 0-50 21.966-50 49.054C-50-88.849 0 0 0 0s50-88.849 50-115.946C50-143.034 27.605-165 0-165z",SQUARE_PIN="M 50 -119.876 -50 -119.876 -50 -19.876 -13.232 -19.876 0.199 0 13.63 -19.876 50 -19.876 Z",SHIELD="M42.8-72.919c0.663-7.855 3.029-15.066 7.2-21.675L34.002-110c-5.054 4.189-10.81 6.509-17.332 6.919 c-5.976 0.52-11.642-0.574-16.971-3.287c-5.478 2.626-11.121 3.723-17.002 3.287c-6.086-0.523-11.577-2.602-16.495-6.281 l-16.041 15.398c3.945 6.704 6.143 13.72 6.574 21.045c0.205 3.373-0.795 8.016-3.038 14.018c-1.175 3.327-2.061 6.213-2.667 8.627 c-0.562 2.394-0.911 4.34-1.027 5.801c-0.082 6.396 1.78 12.168 5.602 17.302c2.986 3.745 7.911 7.886 14.748 12.41 c7.482 3.665 13.272 6.045 17.326 7.06c1.163 0.521 2.301 1.025 3.363 1.506C-7.9-5.708-6.766-5.232-5.586-4.713 C-3.034-3.242-1.243-1.646-0.301 0C0.858-1.782 2.69-3.338 5.122-4.713c1.717-0.723 3.173-1.346 4.341-1.896 c1.167-0.494 2.037-0.865 2.54-1.09c0.866-0.414 2.002-0.888 3.376-1.41c1.386-0.527 3.101-1.168 5.144-1.882 c3.951-1.348 6.83-2.62 8.655-3.77c6.634-4.524 11.48-8.595 14.566-12.235c3.958-5.152 5.879-10.953 5.79-17.475 c-0.232-2.922-1.52-7.594-3.85-13.959C43.463-64.631 42.479-69.445 42.8-72.919z",ROUTE="M49.986-58.919c-0.51-27.631-16.538-38.612-17.195-39.049l-2.479-1.692l-2.5 1.689c-4.147 2.817-8.449 4.247-12.783 4.247 c-7.178 0-12.051-3.864-12.256-4.032L-0.023-100l-2.776 2.248c-0.203 0.165-5.074 4.028-12.253 4.028 c-4.331 0-8.63-1.429-12.788-4.253l-2.486-1.678l-2.504 1.692c-1.702 1.17-16.624 12.192-17.165 38.907 C-50.211-56.731-43.792-12.754-0.003 0C47.609-13.912 50.23-56.018 49.986-58.919z",ROUNDED="M50-80c0-11-9-20-20-20h-60c-11 0-20 9-20 20v60c0 11 9 20 20 20h60c11 0 20-9 20-20V-80z",inherits=function(a,b){function c(){}c.prototype=b.prototype,a.superClass_=b.prototype,a.prototype=new c,a.prototype.constructor=a};inherits(Marker,google.maps.Marker),Marker.prototype.setMap=function(){google.maps.Marker.prototype.setMap.apply(this,arguments),this.MarkerLabel&&this.MarkerLabel.setMap.apply(this.MarkerLabel,arguments)};var MarkerLabel=function(a){var b=this;this.setValues(a),this.div=document.createElement("div"),this.div.className="marker-label";var c=document.createElement("span");c.className="marker-icon",this.div.appendChild(c),google.maps.event.addDomListener(this.div,"click",function(a){a.stopPropagation&&a.stopPropagation(),google.maps.event.trigger(b.marker,"click")})};MarkerLabel.prototype=new google.maps.OverlayView,MarkerLabel.prototype.onAdd=function(){var a=(this.getPanes().overlayImage.appendChild(this.div),this);this.listeners=[google.maps.event.addListener(this,"position_changed",function(){a.draw()}),google.maps.event.addListener(this,"text_changed",function(){a.draw()}),google.maps.event.addListener(this,"zindex_changed",function(){a.draw()})]},MarkerLabel.prototype.onRemove=function(){this.div.parentNode.removeChild(this.div);for(var a=0,b=this.listeners.length;b>a;++a)google.maps.event.removeListener(this.listeners[a])},MarkerLabel.prototype.draw=function(){var a=this.getProjection(),b=a.fromLatLngToDivPixel(this.get("position")),c=this.div;c.style.left=b.x+"px",c.style.top=b.y+"px",c.style.display="block",c.style.zIndex=this.get("zIndex"),this.div.innerHTML=this.get("text").toString()};var model={position:ko.observable(),lat:ko.observable(),lng:ko.observable(),mapOptions:ko.observable(),drawnMap:ko.observable(),userMarker:ko.observable(),artMarkersArray:ko.observableArray([]),museumMarkersArray:ko.observableArray([]),infoBox:new InfoBox,showCheckboxes:ko.observable(!1),showMap:ko.observable(!1),showFilterInputBox:ko.observable(!1),artCheckbox:ko.observable(!1),museumCheckbox:ko.observable(!1),cityInput:ko.observable(""),searchTermsArray:ko.observableArray([]),businessNamesArray:ko.observableArray([]),filteredArray:ko.observableArray([]),photoIdsArray:ko.observableArray([])},helperFunctions={fillArtMarkersArray:function(a,b){var c=a.length;if(b==google.maps.places.PlacesServiceStatus.OK){for(var d=0;c>d;d++){var e=a[d].geometry.location.lat(),f=a[d].geometry.location.lng(),g=new google.maps.LatLng(e,f),h=a[d].place_id,i=a[d].name,j=a[d].vicinity,k=(encodeURIComponent(i),new Marker({map:model.drawnMap(),position:g,title:i,address:j,placeId:h,zIndex:9,icon:{path:MAP_PIN,fillColor:"#0E77E9",fillOpacity:1,strokeColor:"",strokeWeight:0,scale:.26},label:'<i class="map-icon-art-gallery art-gallery"></i>',infoBox:function(){model.infoBox.setContent(this.title+'<br /><span class="info-box-address">'+this.address+"</span>"),model.infoBox.open(model.drawnMap(),this)}}));model.artMarkersArray.push(k),model.photoIdsArray.push(h)}helperFunctions.addArtMarkerListener(model.artMarkersArray())}},fillMuseumMarkersArray:function(a,b){var c=a.length;if(b==google.maps.places.PlacesServiceStatus.OK){for(var d=0;c>d;d++){var e=a[d].geometry.location.lat(),f=a[d].geometry.location.lng(),g=new google.maps.LatLng(e,f),h=a[d].place_id,i=a[d].name,j=a[d].vicinity,k=(encodeURIComponent(i),new Marker({map:model.drawnMap(),position:g,title:i,address:j,placeId:h,zIndex:9,icon:{path:MAP_PIN,fillColor:"#0E77E9",fillOpacity:1,strokeColor:"",strokeWeight:0,scale:.26},label:'<i class="map-icon-museum museum"></i>',infoBox:function(){model.infoBox.setContent(this.title+'<br /><span class="info-box-address">'+this.address+"</span>"),model.infoBox.open(model.drawnMap(),this)}}));model.museumMarkersArray.push(k),model.photoIdsArray.push(h)}helperFunctions.addMuseumMarkerListener(model.museumMarkersArray())}},addArtMarkerListener:function(a){for(var b=a.length,c=0;b>c;c++){var d=a[c];google.maps.event.addListener(d,"click",function(a){return function(){a.infoBox()}}(d))}},addMuseumMarkerListener:function(a){for(var b=a.length,c=0;b>c;c++){var d=a[c];google.maps.event.addListener(d,"click",function(a){return function(){a.infoBox()}}(d))}},hideShowMarkers:ko.computed(function(){model.artCheckbox()||model.artMarkersArray().forEach(function(a){a.setMap(null)}),model.museumCheckbox()||model.museumMarkersArray().forEach(function(a){a.setMap(null)}),model.artCheckbox()&&model.artMarkersArray().forEach(function(a){a.setMap(model.drawnMap())}),model.museumCheckbox()&&model.museumMarkersArray().forEach(function(a){a.setMap(model.drawnMap())})}),addFlickrImages:function(a,b,c,d,e){apiResponse="https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key=4c1c3a64fcef86837a9839120dcd9da9&text="+b+"&content_type=1&accuracy=13&tag_mode=all&min_upload_date=2014&media=photos&lat="+d+"&lon="+e+"&format=json&nojsoncallback=1",$.getJSON(apiResponse,function(d){if(d.photos.total>1){var e=d.photos.photo[1],f=e.farm,g=e.server,h=e.id,i=e.secret,j=a.placeId,k="https://farm"+f+".staticflickr.com/"+g+"/"+h+"_"+i+"_n.jpg",l='<img id="'+j+'" width="320" src="'+k+'" />';a.infoBox=function(a){return function(){model.infoBox.setContent(b+'<br /><span class="info-box-address">'+c+"</span><br />"+a),model.infoBox.open(model.drawnMap(),this)}}(l)}else a.infoBox=function(){model.infoBox.setContent(b+'<br /><span class="info-box-address">'+c+"</span>"),model.infoBox.open(model.drawnMap(),this)}}).fail(function(){a.infoBox=function(){model.infoBox.setContent(b+'<br /><span class="info-box-address">'+c+"</span>"),model.infoBox.open(model.drawnMap(),this)}})},checkIgnored:function(a){switch(a){case"the":return!1;case"in":return!1;case"a":return!1;case"for":return!1;case"of":return!1;case"on":return!1;default:return!0}},clearMarkers:function(){var a=document.getElementById("art_gallery"),b=document.getElementById("museum");model.artMarkersArray([]),model.artMarkersArray().length=0,model.museumMarkersArray([]),model.museumMarkersArray().length=0,document.getElementById("filter-input").value="",a.disabled=!1,b.disabled=!1,model.artCheckbox(!1),model.museumCheckbox(!1)}},mapViewModel={initialize:ko.computed(function(){var a=function(a){model.position(a),model.lat(model.position().coords.latitude),model.lng(model.position().coords.longitude)};navigator.geolocation&&navigator.geolocation.getCurrentPosition(a)}),updateLatLng:function(){var a=document.getElementById("city-input").value,b=a.split(" "),c=b.join("+"),d="https://maps.googleapis.com/maps/api/geocode/json?address="+c+"&key=AIzaSyB4mgEnfU7A2ngaDKEJBbsIs7qLxT7ULCg";$.getJSON(d,function(b){if("ZERO_RESULTS"!=b.status&&""!=a)helperFunctions.clearMarkers(),model.lat(b.results[0].geometry.location.lat),model.lng(b.results[0].geometry.location.lng);else{var c=function(a){model.position(a),model.lat(model.position().coords.latitude),model.lng(model.position().coords.longitude)};helperFunctions.clearMarkers(),navigator.geolocation?navigator.geolocation.getCurrentPosition(c):alert("There was an error in determining your location. Please (1)enable geolocation AND/OR (2)enter a valid city and state.")}}).fail(function(){alert("There was an error in determining your location. Please check your internet connection.")})},makeMapOptions:ko.computed(function(){var a=new google.maps.LatLng(model.lat(),model.lng());model.mapOptions({center:a,zoom:13,panControl:!1,mapTypeControl:!1,streetViewControl:!1,styles:[{stylers:[{lightness:-8},{hue:"#7BFF00"}]},{featureType:"road",stylers:[{hue:"#FFC915"},{saturation:-42}]}]})}),makeInfoBoxOptions:ko.computed(function(){model.infoBox.setOptions({boxStyle:{background:"rgba(239, 244, 250, 0.85)",color:"#0738B6",textAlign:"left",border:"1px solid",width:"341px",padding:"10px"}})}),makeMapObj:ko.computed(function(){model.drawnMap(new google.maps.Map(document.getElementById("map-canvas"),model.mapOptions())),""!=document.getElementById("map-canvas").innerHTML&&(model.showCheckboxes(!0),model.showMap(!0))}),makeUserMarker:ko.computed(function(){model.userMarker(new Marker({map:model.drawnMap(),position:model.drawnMap().center,title:"You are here!",zIndex:9,icon:{path:SQUARE_PIN,fillColor:"#0E77E9",fillOpacity:1,strokeColor:"",strokeWeight:0,scale:.36},label:'<i class="map-icon-walking"></i><div id="walking">You are here!</div>'}))}),setupArtArray:ko.computed(function(){var a=new google.maps.places.PlacesService(model.drawnMap()),b={location:model.drawnMap().center,radius:"6200",types:["art_gallery"]};a.nearbySearch(b,helperFunctions.fillArtMarkersArray)}),setupMuseumArray:ko.computed(function(){var a=new google.maps.places.PlacesService(model.drawnMap()),b={location:model.drawnMap().center,radius:"6200",types:["museum"]};a.nearbySearch(b,helperFunctions.fillMuseumMarkersArray)}),listClickCallback:function(a){a.infoBox()},updateShowFilterInput:ko.computed(function(){model.artCheckbox()||model.museumCheckbox()?(model.showFilterInputBox(!0),document.getElementById("business-list").style.bottom="5%"):model.artCheckbox()||model.museumCheckbox()?(model.showFilterInputBox(!0),document.getElementById("business-list").style.bottom="5%"):(model.showFilterInputBox(!1),document.getElementById("business-list").style.bottom="-999px")}),normalizeSearchTerm:function(){var a=document.getElementById("filter-input").value,b=a.split(" "),c=document.getElementById("art_gallery"),d=document.getElementById("museum"),e=document.getElementById("art-galleries"),f=document.getElementById("museums"),g=b.length;if(model.filteredArray([]),model.searchTermsArray([]),""==a)return c.disabled=!1,d.disabled=!1,document.getElementById("filtered-businesses").innerHTML="",model.artCheckbox()&&(e.style.display="block",model.artMarkersArray().forEach(function(a){a.setMap(model.drawnMap())})),model.museumCheckbox()&&(f.style.display="block",model.museumMarkersArray().forEach(function(a){a.setMap(model.drawnMap())})),!1;c.disabled=!0,d.disabled=!0,e.style.display="none",f.style.display="none",model.artMarkersArray().forEach(function(a){a.setMap(null)}),model.museumMarkersArray().forEach(function(a){a.setMap(null)});for(var h=0;g>h;h++){var i=b[h],j=/[A-z0-9]/g,k=i.match(j),l=k.join("");helperFunctions.checkIgnored(l)&&model.searchTermsArray.push(l)}return!1},businessSearch:ko.computed(function(){function a(a,d){for(var d=0;c>d;d++){var e=new RegExp(b[d],"gi"),f=a.title;if(f.match(e))return a.setMap(model.drawnMap()),!0}}var b=model.searchTermsArray(),c=b.length;model.filteredArray(model.artCheckbox()&&!model.museumCheckbox()?model.artMarkersArray().filter(a):!model.artCheckbox()&&model.museumCheckbox()?model.museumMarkersArray().filter(a):model.artCheckbox()&&model.museumCheckbox()?model.artMarkersArray().concat(model.museumMarkersArray()).filter(a):{title:"no matching businesses found"})}),setupFlickrAPI:ko.computed(function(){model.artMarkersArray().forEach(function(a,b){var a=a,c=a.title,d=a.address,e=a.position.lat(),f=a.position.lng(),g=model.artMarkersArray,h=b;!function(a,b,c,d,e,f,g){return helperFunctions.addFlickrImages(a,b,c,d,e,f,g)}(a,c,d,e,f,g,h)}),model.museumMarkersArray().forEach(function(a,b){var a=a,c=a.title,d=a.address,e=a.position.lat(),f=a.position.lng(),g=model.museumMarkersArray,h=b;!function(a,b,c,d,e,f,g){return helperFunctions.addFlickrImages(a,b,c,d,e,f,g)}(a,c,d,e,f,g,h)})})};ko.applyBindings(mapViewModel);